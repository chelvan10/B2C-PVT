# ============================================================================
# ğŸš€ COMPLETE NPM & PLAYWRIGHT COMMAND REFERENCE
# All Possible Test Execution Commands for B2C PVT Demo Framework
# ============================================================================

.PHONY: help-commands npm-* npx-* pw-*

help-commands: ## ğŸ“š Display all available NPM and Playwright commands
	@echo "ğŸš€ COMPLETE COMMAND REFERENCE - B2C PVT Demo Framework"
	@echo "============================================================================"
	@echo "ğŸ“‹ COMMAND CATEGORIES:"
	@echo "  npm-*     - NPM script commands"
	@echo "  npx-*     - Direct Playwright commands"
	@echo "  pw-*      - Advanced Playwright options"
	@echo ""
	@awk 'BEGIN {FS = ":.*?## "} /^[a-zA-Z_-]+:.*?## / {printf "  \033[36m%-35s\033[0m %s\n", $$1, $$2}' $(MAKEFILE_LIST)

# ============================================================================
# ğŸš€ CORE NPM COMMANDS
# ============================================================================

npm-test: ## ğŸ§ª Run all tests (npm test)
	npm test

npm-test-run: ## ğŸ§ª Run all tests (npm run test)
	npm run test

npm-test-headed: ## ğŸ‘€ Run tests with visible browser
	npm run test:headed

# ============================================================================
# ğŸ“Š NPM TEST CATEGORIES
# ============================================================================

npm-smoke: ## ğŸ’¨ Critical path tests
	npm run test:smoke

npm-smoke-comprehensive: ## ğŸ”¥ Detailed smoke tests
	npm run test:smoke:comprehensive

npm-e2e: ## ğŸ›£ï¸ End-to-end tests
	npm run test:e2e

npm-e2e-comprehensive: ## ğŸ¯ Comprehensive E2E tests
	npm run test:e2e:comprehensive

npm-api: ## ğŸ”Œ API validation tests
	npm run test:api

# ============================================================================
# ğŸ“± NPM DEVICE & BROWSER TESTING
# ============================================================================

npm-mobile: ## ğŸ“± Android + iPhone testing
	npm run test:mobile

npm-android: ## ğŸ¤– Android (Pixel 5) only
	npm run test:android

npm-iphone: ## ğŸ“± iPhone 12 only
	npm run test:iphone

npm-browsers: ## ğŸŒ Chrome + Firefox + Edge
	npm run test:browsers

npm-all-devices: ## ğŸ¯ All browsers + mobile devices
	npm run test:all-devices

# ============================================================================
# ğŸ¯ NPM TEST TYPE FILTERING
# ============================================================================

npm-positive: ## âœ… Happy path scenarios
	npm run test:positive

npm-negative: ## âŒ Error handling tests
	npm run test:negative

npm-edge: ## âš¡ Edge case scenarios
	npm run test:edge

npm-performance: ## ğŸš€ Performance tests
	npm run test:performance

npm-accessibility: ## â™¿ Accessibility tests
	npm run test:accessibility

npm-comprehensive: ## ğŸ† Smoke + E2E + API combined
	npm run test:comprehensive

# ============================================================================
# ğŸ“Š NPM REPORTING
# ============================================================================

npm-report: ## ğŸ“Š Open HTML test report
	npm run report

npm-report-allure: ## ğŸ¨ Generate and open Allure report
	npm run report:allure

npm-report-serve: ## ğŸŒ Serve Allure report on local server
	npm run report:serve

# ============================================================================
# ğŸ­ DIRECT PLAYWRIGHT COMMANDS
# ============================================================================

npx-test: ## ğŸ§ª Run all tests (npx playwright test)
	npx playwright test

npx-test-headed: ## ğŸ‘€ Run with visible browser
	npx playwright test --headed

npx-test-debug: ## ğŸ› Debug mode with inspector
	npx playwright test --debug

# ============================================================================
# ğŸ¯ PLAYWRIGHT PROJECT-SPECIFIC
# ============================================================================

npx-chrome-auth: ## ğŸŒ Desktop Chrome authenticated
	npx playwright test --project=desktop-chrome-auth

npx-chrome-public: ## ğŸŒ Desktop Chrome public pages
	npx playwright test --project=desktop-chrome-public

npx-firefox: ## ğŸ¦Š Desktop Firefox
	npx playwright test --project=desktop-firefox

npx-edge: ## ğŸ”· Desktop Edge
	npx playwright test --project=desktop-edge

npx-android: ## ğŸ¤– Mobile Android (Pixel 5)
	npx playwright test --project=mobile-android

npx-iphone: ## ğŸ“± Mobile iPhone 12
	npx playwright test --project=mobile-iphone

npx-api: ## ğŸ”Œ API testing project
	npx playwright test --project=api

npx-extensions: ## ğŸ§© Chrome extensions testing
	npx playwright test --project=chromium-with-extensions

# ============================================================================
# ğŸ“ PLAYWRIGHT FILE-SPECIFIC
# ============================================================================

npx-homepage: ## ğŸ  Homepage smoke test
	npx playwright test tests/smoke/homepage.spec.ts

npx-homepage-comprehensive: ## ğŸ  Comprehensive homepage test
	npx playwright test tests/smoke/homepage-comprehensive.spec.ts

npx-search: ## ğŸ” Search functionality test
	npx playwright test tests/e2e/mitre10-search.spec.ts

npx-search-comprehensive: ## ğŸ” Comprehensive search test
	npx playwright test tests/e2e/mitre10-search-comprehensive.spec.ts

npx-api-tests: ## ğŸ”Œ API validation tests
	npx playwright test tests/api/mitre10-api.spec.ts

# ============================================================================
# ğŸ“‚ PLAYWRIGHT DIRECTORY-SPECIFIC
# ============================================================================

npx-smoke-dir: ## ğŸ’¨ All smoke tests directory
	npx playwright test tests/smoke/

npx-e2e-dir: ## ğŸ›£ï¸ All E2E tests directory
	npx playwright test tests/e2e/

npx-api-dir: ## ğŸ”Œ All API tests directory
	npx playwright test tests/api/

# ============================================================================
# ğŸ” PLAYWRIGHT PATTERN MATCHING
# ============================================================================

npx-grep-search: ## ğŸ” Tests matching "search"
	npx playwright test --grep="search"

npx-grep-positive: ## âœ… Positive test cases
	npx playwright test --grep="Positive Test Cases"

npx-grep-negative: ## âŒ Negative test cases
	npx playwright test --grep="Negative Test Cases"

npx-grep-performance: ## ğŸš€ Performance tests
	npx playwright test --grep="Performance"

npx-grep-accessibility: ## â™¿ Accessibility tests
	npx playwright test --grep="Accessibility"

npx-grep-edge: ## âš¡ Edge cases
	npx playwright test --grep="Edge Cases"

# ============================================================================
# âš¡ PLAYWRIGHT ADVANCED OPTIONS
# ============================================================================

npx-parallel-4: ## âš¡ 4 parallel workers
	npx playwright test --workers=4

npx-parallel-8: ## âš¡ 8 parallel workers
	npx playwright test --workers=8

npx-serial: ## ğŸ”„ Serial execution (1 worker)
	npx playwright test --workers=1

npx-retry-3: ## ğŸ”„ Retry 3 times on failure
	npx playwright test --retries=3

npx-repeat-2: ## ğŸ”„ Repeat each test 2 times
	npx playwright test --repeat-each=2

npx-timeout-60: ## â±ï¸ 60 second timeout
	npx playwright test --timeout=60000

# ============================================================================
# ğŸ“Š PLAYWRIGHT REPORTING OPTIONS
# ============================================================================

npx-report-list: ## ğŸ“‹ List reporter
	npx playwright test --reporter=list

npx-report-html: ## ğŸ“Š HTML reporter
	npx playwright test --reporter=html

npx-report-json: ## ğŸ“„ JSON reporter
	npx playwright test --reporter=json

npx-report-junit: ## ğŸ“‹ JUnit XML reporter
	npx playwright test --reporter=junit

npx-report-allure: ## ğŸ¨ Allure reporter
	npx playwright test --reporter=allure-playwright

npx-report-multi: ## ğŸ“Š Multiple reporters
	npx playwright test --reporter=list,html,json,junit,allure-playwright

# ============================================================================
# ğŸ”§ PLAYWRIGHT OUTPUT CONTROL
# ============================================================================

npx-output-custom: ## ğŸ“ Custom output directory
	npx playwright test --output=custom-results

npx-quiet: ## ğŸ”‡ Minimal output
	npx playwright test --quiet

npx-verbose: ## ğŸ“¢ Detailed output
	npx playwright test --verbose

# ============================================================================
# ğŸ¯ PLAYWRIGHT COMBINED EXECUTIONS
# ============================================================================

npx-chrome-android: ## ğŸŒğŸ“± Chrome + Android
	npx playwright test --project=desktop-chrome-auth --project=mobile-android

npx-firefox-edge: ## ğŸ¦ŠğŸ”· Firefox + Edge
	npx playwright test --project=desktop-firefox --project=desktop-edge

npx-all-desktop: ## ğŸ–¥ï¸ All desktop browsers
	npx playwright test --project=desktop-chrome-auth --project=desktop-firefox --project=desktop-edge

npx-all-mobile: ## ğŸ“± All mobile devices
	npx playwright test --project=mobile-android --project=mobile-iphone

npx-smoke-mobile: ## ğŸ’¨ğŸ“± Smoke tests on mobile
	npx playwright test tests/smoke/ --project=mobile-android

npx-e2e-chrome: ## ğŸ›£ï¸ğŸŒ E2E tests on Chrome
	npx playwright test tests/e2e/ --project=desktop-chrome-auth

# ============================================================================
# ğŸ” PLAYWRIGHT ADVANCED FILTERING
# ============================================================================

npx-search-android: ## ğŸ”ğŸ¤– Search tests on Android
	npx playwright test --grep="search" --project=mobile-android

npx-performance-json: ## ğŸš€ğŸ“„ Performance tests with JSON report
	npx playwright test --grep="Performance" --reporter=json

npx-smoke-allure: ## ğŸ’¨ğŸ¨ Smoke tests with Allure report
	npx playwright test tests/smoke/ --reporter=allure-playwright

# ============================================================================
# ğŸ¤– PLAYWRIGHT CI/CD OPTIMIZED
# ============================================================================

npx-ci-mode: ## ğŸ¤– CI mode execution
	CI=true npx playwright test

npx-ci-reports: ## ğŸ¤–ğŸ“Š CI with multiple reports
	CI=true npx playwright test --reporter=list,html,junit

npx-headless: ## ğŸ‘» Force headless mode
	HEADLESS=true npx playwright test

# ============================================================================
# ğŸ”§ PLAYWRIGHT UTILITIES
# ============================================================================

npx-install: ## ğŸ“¦ Install browsers
	npx playwright install

npx-install-deps: ## ğŸ“¦ Install system dependencies
	npx playwright install-deps

npx-version: ## â„¹ï¸ Check Playwright version
	npx playwright --version

npx-codegen: ## ğŸ¬ Generate test code
	npx playwright codegen https://www.mitre10.co.nz/

npx-codegen-ts: ## ğŸ¬ Generate TypeScript code
	npx playwright codegen --target=typescript https://www.mitre10.co.nz/

npx-show-report: ## ğŸ“Š Open HTML report
	npx playwright show-report

npx-show-trace: ## ğŸ‘ï¸ Open trace viewer (requires trace file)
	npx playwright show-trace test-results/*/trace.zip

# ============================================================================
# ğŸŒ PLAYWRIGHT ENVIRONMENT-SPECIFIC
# ============================================================================

npx-staging: ## ğŸ—ï¸ Run against staging environment
	MITRE10_BASE_URL=https://staging.mitre10.co.nz/ npx playwright test

npx-production: ## ğŸš€ Run against production environment
	NODE_ENV=production npx playwright test

npx-local: ## ğŸ  Run against local environment
	MITRE10_BASE_URL=http://localhost:3000/ npx playwright test

# ============================================================================
# ğŸ’ª PLAYWRIGHT STRESS & LOAD TESTING
# ============================================================================

npx-stress-test: ## ğŸ’ª High-load stress testing
	npx playwright test --workers=8 --retries=0 --repeat-each=3

npx-load-test: ## ğŸ“ˆ Load testing with performance focus
	npx playwright test --grep="Performance" --workers=4 --repeat-each=5

npx-endurance-test: ## ğŸƒ Long-running endurance test
	npx playwright test --repeat-each=10 --timeout=120000

# ============================================================================
# ğŸ¯ PLAYWRIGHT SPECIFIC SCENARIOS
# ============================================================================

npx-smoke-quick: ## âš¡ Quick smoke test validation
	npx playwright test tests/smoke/homepage.spec.ts --workers=1

npx-regression-full: ## ğŸ”„ Full regression suite
	npx playwright test --project=desktop-chrome-auth --project=mobile-android --reporter=allure-playwright

npx-cross-browser: ## ğŸŒ Cross-browser validation
	npx playwright test tests/smoke/ --project=desktop-chrome-auth --project=desktop-firefox --project=desktop-edge

npx-mobile-comprehensive: ## ğŸ“± Comprehensive mobile testing
	npx playwright test --project=mobile-android --project=mobile-iphone --reporter=html

# ============================================================================
# ğŸ” PLAYWRIGHT DEBUG & ANALYSIS
# ============================================================================

npx-debug-search: ## ğŸ› Debug search functionality
	npx playwright test tests/e2e/mitre10-search.spec.ts --debug

npx-debug-headed: ## ğŸ›ğŸ‘€ Debug with visible browser
	npx playwright test --debug --headed

npx-trace-on: ## ğŸ“¹ Run with trace collection
	npx playwright test --trace=on

npx-video-on: ## ğŸ¥ Run with video recording
	npx playwright test --video=on

npx-screenshot-on: ## ğŸ“¸ Run with screenshot capture
	npx playwright test --screenshot=on

# ============================================================================
# ğŸ“Š PLAYWRIGHT CUSTOM COMBINATIONS
# ============================================================================

npx-full-matrix: ## ğŸ¯ Complete device and browser matrix
	npx playwright test --project=desktop-chrome-auth --project=desktop-firefox --project=desktop-edge --project=mobile-android --project=mobile-iphone

npx-api-performance: ## ğŸ”ŒğŸš€ API and performance tests
	npx playwright test tests/api/ --grep="Performance"

npx-security-compliance: ## ğŸ”âœ… Security and compliance tests
	npx playwright test --grep="security|Security|accessibility|Accessibility"

# ============================================================================
# ğŸ¯ EXAMPLE USAGE SCENARIOS
# ============================================================================

demo-npm-quick: ## ğŸš€ Quick NPM demo
	npm run test:smoke && npm run report

demo-npx-comprehensive: ## ğŸ† Comprehensive Playwright demo
	npx playwright test --project=desktop-chrome-auth --project=mobile-android --reporter=allure-playwright

demo-cross-platform: ## ğŸŒ Cross-platform demo
	npx playwright test tests/smoke/ --project=desktop-chrome-auth --project=mobile-android --project=mobile-iphone

# ============================================================================
# ğŸ“‹ COMMAND SUMMARY
# ============================================================================

commands-summary: ## ğŸ“‹ Display command summary
	@echo "ğŸ“‹ COMMAND SUMMARY:"
	@echo "==================="
	@echo "ğŸš€ NPM Commands: $(shell grep -c "^npm-" $(MAKEFILE_LIST))"
	@echo "ğŸ­ NPX Commands: $(shell grep -c "^npx-" $(MAKEFILE_LIST))"
	@echo "ğŸ¯ Total Commands: $(shell grep -c "^[a-zA-Z_-]*:" $(MAKEFILE_LIST))"
	@echo ""
	@echo "ğŸ“š Use 'make help-commands' for complete list"
	@echo "ğŸ¯ Use 'make <command-name>' to execute any command"

# ============================================================================
# ğŸ¯ QUICK REFERENCE
# ============================================================================

quick-ref: ## ğŸ“š Quick reference guide
	@echo "ğŸš€ QUICK REFERENCE - Most Used Commands:"
	@echo "========================================"
	@echo "Basic Testing:"
	@echo "  make npm-test              # All tests"
	@echo "  make npm-smoke             # Smoke tests"
	@echo "  make npm-mobile            # Mobile tests"
	@echo ""
	@echo "Advanced Testing:"
	@echo "  make npx-chrome-auth       # Chrome authenticated"
	@echo "  make npx-parallel-4        # 4 parallel workers"
	@echo "  make npx-debug             # Debug mode"
	@echo ""
	@echo "Reporting:"
	@echo "  make npm-report            # HTML report"
	@echo "  make npm-report-allure     # Allure report"
	@echo ""
	@echo "ğŸ“š For complete list: make help-commands"